name: CI

on: [push]

jobs:
  setup:
    runs-on: ubuntu-latest
    
    steps:
    - name: Setup build environment
      run: |
        sudo git clone https://github.com/MCJack123/craftos2-rom /usr/share/craftos
        sudo apt update
        sudo apt install -y liblua5.1-0-dev libsdl2-dev libsdl2-mixer-dev libhpdf-dev libpng++-dev libpoco-dev

  build:

    runs-on: ubuntu-latest
    needs: setup
    steps:
    - uses: actions/checkout@v1
    - name: Run CraftOSTest
      run: make test
